<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<iso:CardInfo xmlns="urn:oasis:names:tc:dss:1.0:core:schema"
	      xmlns:ns2="http://www.w3.org/2000/09/xmldsig#"
	      xmlns:iso="urn:iso:std:iso-iec:24727:tech:schema"
	      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	      xsi:schemaLocation="urn:iso:std:iso-iec:24727:tech:schema http://repository.cardinfo.eu/schema/CardInfo.xsd">

    <iso:CardType>
	<iso:ObjectIdentifier>http://cif.id.ee/eid</iso:ObjectIdentifier>
	<iso:CardTypeName xml:lang="EN">Estonian Identity Card</iso:CardTypeName>
	<iso:CardTypeName xml:lang="DE">Estnischer Personalausweis</iso:CardTypeName>
	<iso:Status>Draft</iso:Status>
	<iso:Date>2012-11-12</iso:Date>
    </iso:CardType>

    <iso:CardIdentification>
	<iso:CharacteristicFeature>
	    <!-- select MF -->
	    <iso:CardCall>
		<iso:CommandAPDU>00A4000C00</iso:CommandAPDU>
		<iso:ResponseAPDU>
		    <iso:Trailer>9000</iso:Trailer>
		</iso:ResponseAPDU>
	    </iso:CardCall>
	    <!-- select EstEID DF -->
	    <iso:CardCall>
		<iso:CommandAPDU>00A4010C02EEEE</iso:CommandAPDU>
		<iso:ResponseAPDU>
		    <iso:Trailer>9000</iso:Trailer>
		</iso:ResponseAPDU>
	    </iso:CardCall>
	    <!-- select EF_PD -->
	    <iso:CardCall>
		<iso:CommandAPDU>00A40200025044</iso:CommandAPDU>
		<iso:ResponseAPDU>
		    <iso:Body>
			<iso:Tag>6F</iso:Tag>
			<iso:DataObject>
			    <iso:Tag>62</iso:Tag>
			    <iso:DataObject>
				<iso:Tag>62</iso:Tag>
				<iso:DataObject>
				    <iso:Tag>83</iso:Tag>
				    <iso:DataObject>
					<iso:MatchingData>
					    <iso:Length>02</iso:Length>
					    <iso:MatchingValue>5044</iso:MatchingValue>
					</iso:MatchingData>
				    </iso:DataObject>
				</iso:DataObject>
			    </iso:DataObject>
			</iso:DataObject>
		    </iso:Body>
		    <iso:Trailer>9000</iso:Trailer>
		</iso:ResponseAPDU>
	    </iso:CardCall>
	</iso:CharacteristicFeature>
    </iso:CardIdentification>

    <iso:ApplicationCapabilities>
	<!-- for version 3 and higher cards -->
	<iso:ImplicitlySelectedApplication>F04573744549442076657220312E30</iso:ImplicitlySelectedApplication>
	<iso:CardApplication>
	    <!--
	    for version 1.0 and 1.1 it have to be
	    <iso:ApplicationIdentifier>D2330000010000010000000000000000</iso:ApplicationIdentifier>
	    Le have to be 27
	    -->
	    <iso:ApplicationName>MF</iso:ApplicationName>
	    <iso:ApplicationIdentifier>F04573744549442076657220312E30</iso:ApplicationIdentifier>
	    <iso:CardApplicationACL>
		<iso:AccessRule>
		    <iso:CardApplicationServiceName>CardApplicationServiceAccess</iso:CardApplicationServiceName>
		    <iso:Action>
			<iso:APIAccessEntryPoint>Initialize</iso:APIAccessEntryPoint>
		    </iso:Action>
		    <iso:SecurityCondition>
			<iso:always>true</iso:always>
		    </iso:SecurityCondition>
		</iso:AccessRule>
		<iso:AccessRule>
		    <iso:CardApplicationServiceName>CardApplicationServiceAccess</iso:CardApplicationServiceName>
		    <iso:Action>
			<iso:APIAccessEntryPoint>Terminate</iso:APIAccessEntryPoint>
		    </iso:Action>
		    <iso:SecurityCondition>
			<iso:always>true</iso:always>
		    </iso:SecurityCondition>
		</iso:AccessRule>
		<iso:AccessRule>
		    <iso:CardApplicationServiceName>ConnectionService</iso:CardApplicationServiceName>
		    <iso:Action>
			<iso:ConnectionServiceAction>CardApplicationConnect</iso:ConnectionServiceAction>
		    </iso:Action>
		    <iso:SecurityCondition>
			<iso:always>true</iso:always>
		    </iso:SecurityCondition>
		</iso:AccessRule>
		<iso:AccessRule>
		    <iso:CardApplicationServiceName>ConnectionService</iso:CardApplicationServiceName>
		    <iso:Action>
			<iso:ConnectionServiceAction>CardApplicationDisconnect</iso:ConnectionServiceAction>
		    </iso:Action>
		    <iso:SecurityCondition>
			<iso:always>true</iso:always>
		    </iso:SecurityCondition>
		</iso:AccessRule>
		<iso:AccessRule>
		    <iso:CardApplicationServiceName>ConnectionService</iso:CardApplicationServiceName>
		    <iso:Action>
			<iso:ConnectionServiceAction>CardApplicationStartSession</iso:ConnectionServiceAction>
		    </iso:Action>
		    <iso:SecurityCondition>
			<iso:always>true</iso:always>
		    </iso:SecurityCondition>
		</iso:AccessRule>
		<iso:AccessRule>
		    <iso:CardApplicationServiceName>ConnectionService</iso:CardApplicationServiceName>
		    <iso:Action>
			<iso:ConnectionServiceAction>CardApplicationEndSession</iso:ConnectionServiceAction>
		    </iso:Action>
		    <iso:SecurityCondition>
			<iso:always>true</iso:always>
		    </iso:SecurityCondition>
		</iso:AccessRule>
		<iso:AccessRule>
		    <iso:CardApplicationServiceName>CardApplicationService</iso:CardApplicationServiceName>
		    <iso:Action>
			<iso:CardApplicationServiceAction>CardApplicationList</iso:CardApplicationServiceAction>
		    </iso:Action>
		    <iso:SecurityCondition>
			<iso:always>true</iso:always>
		    </iso:SecurityCondition>
		</iso:AccessRule>
		<iso:AccessRule>
		    <iso:CardApplicationServiceName>CardApplicationService</iso:CardApplicationServiceName>
		    <iso:Action>
			<iso:CardApplicationServiceAction>CardApplicationServiceList</iso:CardApplicationServiceAction>
		    </iso:Action>
		    <iso:SecurityCondition>
			<iso:always>true</iso:always>
		    </iso:SecurityCondition>
		</iso:AccessRule>
		<iso:AccessRule>
		    <iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
		    <iso:Action>
			<iso:NamedDataServiceAction>DataSetList</iso:NamedDataServiceAction>
		    </iso:Action>
		    <iso:SecurityCondition>
			<iso:always>true</iso:always>
		    </iso:SecurityCondition>
		</iso:AccessRule>
		<iso:AccessRule>
		    <iso:CardApplicationServiceName>DifferentialIdentityService</iso:CardApplicationServiceName>
		    <iso:Action>
			<iso:DifferentialIdentityServiceAction>DIDList</iso:DifferentialIdentityServiceAction>
		    </iso:Action>
		    <iso:SecurityCondition>
			<iso:always>true</iso:always>
		    </iso:SecurityCondition>
		</iso:AccessRule>
		<iso:AccessRule>
		    <iso:CardApplicationServiceName>AuthorizationService</iso:CardApplicationServiceName>
		    <iso:Action>
			<iso:AuthorizationServiceAction>ACLList</iso:AuthorizationServiceAction>
		    </iso:Action>
		    <iso:SecurityCondition>
			<iso:always>true</iso:always>
		    </iso:SecurityCondition>
		</iso:AccessRule>
	    </iso:CardApplicationACL>
	    <iso:DIDInfo>
		<iso:RequirementLevel>PersonalizationMandatory</iso:RequirementLevel>
		<iso:DifferentialIdentity>
		    <iso:DIDName>PIN1</iso:DIDName>
		    <iso:DIDProtocol>urn:oid:1.3.162.15480.3.0.9</iso:DIDProtocol><!--PIN Compare-->
		    <iso:DIDMarker>
			<iso:PinCompareMarker Protocol="urn:oid:1.3.162.15480.3.0.9">
			    <iso:PinRef>
				<!-- fix it -->
				<iso:KeyRef>01</iso:KeyRef>
			    </iso:PinRef>
			    <iso:PasswordAttributes>
				<iso:pwdType>ascii-numeric</iso:pwdType>
				<iso:minLength>4</iso:minLength>
				<iso:storedLength>12</iso:storedLength>
				<iso:maxLength>12</iso:maxLength>
			    </iso:PasswordAttributes>
			    <iso:StateInfo>
				<iso:StateRecognition>
				    <iso:CardCall>
					<iso:CommandAPDU>00A4000C023F00</iso:CommandAPDU>
					<iso:ResponseAPDU>
					    <iso:Trailer>9000</iso:Trailer>
					</iso:ResponseAPDU>
				    </iso:CardCall>
				    <iso:CardCall>
					<iso:CommandAPDU>00A4020C020016</iso:CommandAPDU>
					<iso:ResponseAPDU>
					    <iso:Trailer>9000</iso:Trailer>
					</iso:ResponseAPDU>
				    </iso:CardCall>
				    <iso:CardCall>
					<iso:CommandAPDU>00B20204FF</iso:CommandAPDU>
					<iso:ResponseAPDU>
					    <iso:Body>
						<iso:MatchingData>
						    <iso:Offset>05</iso:Offset>
						    <iso:Length>01</iso:Length>
						    <iso:MatchingValue>03</iso:MatchingValue>
						    <iso:Mask>FF</iso:Mask>
						</iso:MatchingData>
					    </iso:Body>
					    <iso:Trailer>9000</iso:Trailer>
					    <iso:Conclusion>
						<iso:RecognizedState>PIN1_ACTIVATED_RC3</iso:RecognizedState>
					    </iso:Conclusion>
					</iso:ResponseAPDU>
					<iso:ResponseAPDU>
					    <iso:Body>
						<iso:MatchingData>
						    <iso:Offset>05</iso:Offset>
						    <iso:Length>01</iso:Length>
						    <iso:MatchingValue>02</iso:MatchingValue>
						    <iso:Mask>FF</iso:Mask>
						</iso:MatchingData>
					    </iso:Body>
					    <iso:Trailer>9000</iso:Trailer>
					    <iso:Conclusion>
						<iso:RecognizedState>PIN1_ACTIVATED_RC2</iso:RecognizedState>
					    </iso:Conclusion>
					</iso:ResponseAPDU>
					<iso:ResponseAPDU>
					    <iso:Body>
						<iso:MatchingData>
						    <iso:Offset>05</iso:Offset>
						    <iso:Length>01</iso:Length>
						    <iso:MatchingValue>01</iso:MatchingValue>
						    <iso:Mask>FF</iso:Mask>
						</iso:MatchingData>
					    </iso:Body>
					    <iso:Trailer>9000</iso:Trailer>
					    <iso:Conclusion>
						<iso:RecognizedState>PIN1_ACTIVATED_RC1</iso:RecognizedState>
					    </iso:Conclusion>
					</iso:ResponseAPDU>
					<iso:ResponseAPDU>
					    <iso:Body>
						<iso:MatchingData>
						    <iso:Offset>05</iso:Offset>
						    <iso:Length>01</iso:Length>
						    <iso:MatchingValue>00</iso:MatchingValue>
						    <iso:Mask>FF</iso:Mask>
						</iso:MatchingData>
					    </iso:Body>
					    <iso:Trailer>9000</iso:Trailer>
					    <iso:Conclusion>
						<iso:RecognizedState>PIN1_BLOCKED</iso:RecognizedState>
					    </iso:Conclusion>
					</iso:ResponseAPDU>
				    </iso:CardCall>
				</iso:StateRecognition>
				<iso:State StateClass="RecognitionNecessary" StateName="PIN1_START"/>
				<iso:State StateClass="NotOperational" StateName="PIN1_BLOCKED">
				    <iso:RetryCounter>0</iso:RetryCounter>
				    <iso:StateTransition TargetState="PIN1_ACTIVATED_RC3">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PUK</iso:DIDName>
					    <iso:DIDState>true</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				</iso:State>
				<iso:State StateClass="Operational" StateName="PIN1_ACTIVATED_RC2">
				    <iso:RetryCounter>2</iso:RetryCounter>
				    <iso:StateTransition TargetState="PIN1_ACTIVATED_RC1">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PIN1</iso:DIDName>
					    <iso:DIDState>false</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				    <iso:StateTransition TargetState="PIN1_ACTIVATED_RC3">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PIN1</iso:DIDName>
					    <iso:DIDState>true</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				</iso:State>
				<iso:State StateClass="Operational" StateName="PIN1_ACTIVATED_RC1">
				    <iso:RetryCounter>1</iso:RetryCounter>
				    <iso:StateTransition TargetState="PIN1_BLOCKED">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PIN1</iso:DIDName>
					    <iso:DIDState>false</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				    <iso:StateTransition TargetState="PIN1_ACTIVATED_RC3">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PIN1</iso:DIDName>
					    <iso:DIDState>true</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				</iso:State>
				<iso:State StateClass="Operational" StateName="PIN1_ACTIVATED_RC3">
				    <iso:RetryCounter>3</iso:RetryCounter>
				    <iso:StateTransition TargetState="PIN1_ACTIVATED_RC2">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PIN1</iso:DIDName>
					    <iso:DIDState>false</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				</iso:State>
			    </iso:StateInfo>
			</iso:PinCompareMarker>
		    </iso:DIDMarker>
		    <iso:DIDScope>global</iso:DIDScope>
		</iso:DifferentialIdentity>
		<iso:DIDACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>DifferentialIdentityService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:DifferentialIdentityServiceAction>DIDGet</iso:DifferentialIdentityServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>DifferentialIdentityService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:DifferentialIdentityServiceAction>DIDAuthenticate</iso:DifferentialIdentityServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>AuthorizationService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:AuthorizationServiceAction>ACLList</iso:AuthorizationServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DIDACL>
	    </iso:DIDInfo>
	    <iso:DIDInfo>
		<iso:RequirementLevel>PersonalizationMandatory</iso:RequirementLevel>
		<iso:DifferentialIdentity>
		    <iso:DIDName>PIN2</iso:DIDName>
		    <iso:DIDProtocol>urn:oid:1.3.162.15480.3.0.9</iso:DIDProtocol><!--PIN Compare-->
		    <iso:DIDMarker>
			<iso:PinCompareMarker Protocol="urn:oid:1.3.162.15480.3.0.9">
			    <iso:PinRef>
				<!-- fix it -->
				<iso:KeyRef>02</iso:KeyRef>
			    </iso:PinRef>
			    <iso:PasswordAttributes>
				<iso:pwdType>ascii-numeric</iso:pwdType>
				<iso:minLength>5</iso:minLength>
				<iso:storedLength>12</iso:storedLength>
				<iso:maxLength>12</iso:maxLength>
			    </iso:PasswordAttributes>
			    <iso:StateInfo>
				<iso:StateRecognition>
				    <iso:CardCall>
					<iso:CommandAPDU>00A4000C023F00</iso:CommandAPDU>
					<iso:ResponseAPDU>
					    <iso:Trailer>9000</iso:Trailer>
					</iso:ResponseAPDU>
				    </iso:CardCall>
				    <iso:CardCall>
					<iso:CommandAPDU>00A4020C020016</iso:CommandAPDU>
					<iso:ResponseAPDU>
					    <iso:Trailer>9000</iso:Trailer>
					</iso:ResponseAPDU>
				    </iso:CardCall>
				    <iso:CardCall>
					<iso:CommandAPDU>00B20204FF</iso:CommandAPDU>
					<iso:ResponseAPDU>
					    <iso:Body>
						<iso:MatchingData>
						    <iso:Offset>05</iso:Offset>
						    <iso:Length>01</iso:Length>
						    <iso:MatchingValue>03</iso:MatchingValue>
						    <iso:Mask>FF</iso:Mask>
						</iso:MatchingData>
					    </iso:Body>
					    <iso:Trailer>9000</iso:Trailer>
					    <iso:Conclusion>
						<iso:RecognizedState>PIN2_ACTIVATED_RC3</iso:RecognizedState>
					    </iso:Conclusion>
					</iso:ResponseAPDU>
					<iso:ResponseAPDU>
					    <iso:Body>
						<iso:MatchingData>
						    <iso:Offset>05</iso:Offset>
						    <iso:Length>01</iso:Length>
						    <iso:MatchingValue>02</iso:MatchingValue>
						    <iso:Mask>FF</iso:Mask>
						</iso:MatchingData>
					    </iso:Body>
					    <iso:Trailer>9000</iso:Trailer>
					    <iso:Conclusion>
						<iso:RecognizedState>PIN2_ACTIVATED_RC2</iso:RecognizedState>
					    </iso:Conclusion>
					</iso:ResponseAPDU>
					<iso:ResponseAPDU>
					    <iso:Body>
						<iso:MatchingData>
						    <iso:Offset>05</iso:Offset>
						    <iso:Length>01</iso:Length>
						    <iso:MatchingValue>01</iso:MatchingValue>
						    <iso:Mask>FF</iso:Mask>
						</iso:MatchingData>
					    </iso:Body>
					    <iso:Trailer>9000</iso:Trailer>
					    <iso:Conclusion>
						<iso:RecognizedState>PIN2_ACTIVATED_RC1</iso:RecognizedState>
					    </iso:Conclusion>
					</iso:ResponseAPDU>
					<iso:ResponseAPDU>
					    <iso:Body>
						<iso:MatchingData>
						    <iso:Offset>05</iso:Offset>
						    <iso:Length>01</iso:Length>
						    <iso:MatchingValue>00</iso:MatchingValue>
						    <iso:Mask>FF</iso:Mask>
						</iso:MatchingData>
					    </iso:Body>
					    <iso:Trailer>9000</iso:Trailer>
					    <iso:Conclusion>
						<iso:RecognizedState>PIN2_BLOCKED</iso:RecognizedState>
					    </iso:Conclusion>
					</iso:ResponseAPDU>
				    </iso:CardCall>
				</iso:StateRecognition>
				<iso:State StateClass="RecognitionNecessary" StateName="PIN2_START"/>
				<iso:State StateClass="NotOperational" StateName="PIN2_BLOCKED">
				    <iso:RetryCounter>0</iso:RetryCounter>
				    <iso:StateTransition TargetState="PIN2_ACTIVATED_RC3">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PUK</iso:DIDName>
					    <iso:DIDState>true</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				</iso:State>
				<iso:State StateClass="Operational" StateName="PIN2_ACTIVATED_RC2">
				    <iso:RetryCounter>2</iso:RetryCounter>
				    <iso:StateTransition TargetState="PIN2_ACTIVATED_RC1">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PIN2</iso:DIDName>
					    <iso:DIDState>false</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				    <iso:StateTransition TargetState="PIN2_ACTIVATED_RC3">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PIN2</iso:DIDName>
					    <iso:DIDState>true</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				</iso:State>
				<iso:State StateClass="Operational" StateName="PIN2_ACTIVATED_RC1">
				    <iso:RetryCounter>1</iso:RetryCounter>
				    <iso:StateTransition TargetState="PIN2_BLOCKED">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PIN2</iso:DIDName>
					    <iso:DIDState>false</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				    <iso:StateTransition TargetState="PIN2_ACTIVATED_RC3">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PIN2</iso:DIDName>
					    <iso:DIDState>true</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				</iso:State>
				<iso:State StateClass="Operational" StateName="PIN2_ACTIVATED_RC3">
				    <iso:RetryCounter>3</iso:RetryCounter>
				    <iso:StateTransition TargetState="PIN2_ACTIVATED_RC2">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PIN2</iso:DIDName>
					    <iso:DIDState>false</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				</iso:State>
			    </iso:StateInfo>
			</iso:PinCompareMarker>
		    </iso:DIDMarker>
		</iso:DifferentialIdentity>
		<iso:DIDACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>DifferentialIdentityService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:DifferentialIdentityServiceAction>DIDGet</iso:DifferentialIdentityServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>DifferentialIdentityService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:DifferentialIdentityServiceAction>DIDAuthenticate</iso:DifferentialIdentityServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>AuthorizationService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:AuthorizationServiceAction>ACLList</iso:AuthorizationServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DIDACL>
	    </iso:DIDInfo>
	    <iso:DIDInfo>
		<iso:RequirementLevel>PersonalizationMandatory</iso:RequirementLevel>
		<iso:DifferentialIdentity>
		    <iso:DIDName>PUK</iso:DIDName>
		    <iso:DIDProtocol>urn:oid:1.3.162.15480.3.0.9</iso:DIDProtocol><!--PIN Compare-->
		    <iso:DIDMarker>
			<iso:PinCompareMarker Protocol="urn:oid:1.3.162.15480.3.0.9">
			    <iso:PinRef>
				<!-- fix it -->
				<iso:KeyRef>00</iso:KeyRef>
			    </iso:PinRef>
			    <iso:PasswordAttributes>
				<iso:pwdType>ascii-numeric</iso:pwdType>
				<iso:minLength>8</iso:minLength>
				<iso:storedLength>12</iso:storedLength>
				<iso:maxLength>12</iso:maxLength>
			    </iso:PasswordAttributes>
			    <iso:StateInfo>
				<iso:StateRecognition>
				    <iso:CardCall>
					<iso:CommandAPDU>00A4000C023F00</iso:CommandAPDU>
					<iso:ResponseAPDU>
					    <iso:Trailer>9000</iso:Trailer>
					</iso:ResponseAPDU>
				    </iso:CardCall>
				    <iso:CardCall>
					<iso:CommandAPDU>00A4020C020016</iso:CommandAPDU>
					<iso:ResponseAPDU>
					    <iso:Trailer>9000</iso:Trailer>
					</iso:ResponseAPDU>
				    </iso:CardCall>
				    <iso:CardCall>
					<iso:CommandAPDU>00B20304FF</iso:CommandAPDU>
					<iso:ResponseAPDU>
					    <iso:Body>
						<iso:MatchingData>
						    <iso:Offset>05</iso:Offset>
						    <iso:Length>01</iso:Length>
						    <iso:MatchingValue>03</iso:MatchingValue>
						    <iso:Mask>FF</iso:Mask>
						</iso:MatchingData>
					    </iso:Body>
					    <iso:Trailer>9000</iso:Trailer>
					    <iso:Conclusion>
						<iso:RecognizedState>PUK_ACTIVATED_RC3</iso:RecognizedState>
					    </iso:Conclusion>
					</iso:ResponseAPDU>
					<iso:ResponseAPDU>
					    <iso:Body>
						<iso:MatchingData>
						    <iso:Offset>05</iso:Offset>
						    <iso:Length>01</iso:Length>
						    <iso:MatchingValue>02</iso:MatchingValue>
						    <iso:Mask>FF</iso:Mask>
						</iso:MatchingData>
					    </iso:Body>
					    <iso:Trailer>9000</iso:Trailer>
					    <iso:Conclusion>
						<iso:RecognizedState>PUK_ACTIVATED_RC2</iso:RecognizedState>
					    </iso:Conclusion>
					</iso:ResponseAPDU>
					<iso:ResponseAPDU>
					    <iso:Body>
						<iso:MatchingData>
						    <iso:Offset>05</iso:Offset>
						    <iso:Length>01</iso:Length>
						    <iso:MatchingValue>01</iso:MatchingValue>
						    <iso:Mask>FF</iso:Mask>
						</iso:MatchingData>
					    </iso:Body>
					    <iso:Trailer>9000</iso:Trailer>
					    <iso:Conclusion>
						<iso:RecognizedState>PUK_ACTIVATED_RC1</iso:RecognizedState>
					    </iso:Conclusion>
					</iso:ResponseAPDU>
					<iso:ResponseAPDU>
					    <iso:Body>
						<iso:MatchingData>
						    <iso:Offset>05</iso:Offset>
						    <iso:Length>01</iso:Length>
						    <iso:MatchingValue>00</iso:MatchingValue>
						    <iso:Mask>FF</iso:Mask>
						</iso:MatchingData>
					    </iso:Body>
					    <iso:Trailer>9000</iso:Trailer>
					    <iso:Conclusion>
						<iso:RecognizedState>PUK_BLOCKED</iso:RecognizedState>
					    </iso:Conclusion>
					</iso:ResponseAPDU>
				    </iso:CardCall>
				</iso:StateRecognition>
				<iso:State StateClass="RecognitionNecessary" StateName="PUK_START"/>
				<iso:State StateClass="NotOperational" StateName="PUK_BLOCKED">
				    <iso:RetryCounter>0</iso:RetryCounter>
				</iso:State>
				<iso:State StateClass="Operational" StateName="PUK_ACTIVATED_RC2">
				    <iso:RetryCounter>2</iso:RetryCounter>
				    <iso:StateTransition TargetState="PUK_ACTIVATED_RC1">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PUK</iso:DIDName>
					    <iso:DIDState>false</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				    <iso:StateTransition TargetState="PUK_ACTIVATED_RC3">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PUK</iso:DIDName>
					    <iso:DIDState>true</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				</iso:State>
				<iso:State StateClass="Operational" StateName="PUK_ACTIVATED_RC1">
				    <iso:RetryCounter>1</iso:RetryCounter>
				    <iso:StateTransition TargetState="PUK_BLOCKED">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PUK</iso:DIDName>
					    <iso:DIDState>false</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				    <iso:StateTransition TargetState="PUK_ACTIVATED_RC3">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PUK</iso:DIDName>
					    <iso:DIDState>true</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				</iso:State>
				<iso:State StateClass="Operational" StateName="PUK_ACTIVATED_RC3">
				    <iso:RetryCounter>3</iso:RetryCounter>
				    <iso:StateTransition TargetState="PUK_ACTIVATED_RC2">
					<iso:DIDAuthenticationState>
					    <iso:DIDName>PUK</iso:DIDName>
					    <iso:DIDState>false</iso:DIDState>
					</iso:DIDAuthenticationState>
				    </iso:StateTransition>
				</iso:State>
			    </iso:StateInfo>
			</iso:PinCompareMarker>
		    </iso:DIDMarker>
		</iso:DifferentialIdentity>
		<iso:DIDACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>DifferentialIdentityService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:DifferentialIdentityServiceAction>DIDGet</iso:DifferentialIdentityServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>DifferentialIdentityService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:DifferentialIdentityServiceAction>DIDAuthenticate</iso:DifferentialIdentityServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>AuthorizationService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:AuthorizationServiceAction>ACLList</iso:AuthorizationServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DIDACL>
	    </iso:DIDInfo>
	    <!-- authentication key -->
	    <iso:DIDInfo>
		<iso:DifferentialIdentity>
		    <iso:DIDName>SK.AUTH</iso:DIDName>
		    <iso:DIDProtocol>urn:oid:1.3.162.15480.3.0.25</iso:DIDProtocol>
		    <iso:DIDMarker>
			<iso:CryptoMarker Protocol="urn:oid:1.3.162.15480.3.0.25">
			    <iso:AlgorithmInfo>
				<iso:Algorithm>signPKCS1_V1_5</iso:Algorithm>
				<iso:AlgorithmIdentifier>
				    <iso:Algorithm>urn:oid:1.2.840.113549.1.1</iso:Algorithm>
				</iso:AlgorithmIdentifier>
				<iso:SupportedOperations>Compute-signature Decipher Internal-authenticate</iso:SupportedOperations>
			    </iso:AlgorithmInfo>
			    <iso:KeyInfo>
				<iso:KeyRef>
				    <iso:KeyRef>11</iso:KeyRef>
				    <!--
				    Do not specify the key size to be compatible with v3.0 card and v3.4
				    (v3.0 has key size 2048 and v3.4 has key size 1024)
				    <iso:KeySize>1024</iso:KeySize>
				    -->
				</iso:KeyRef>
				<iso:SecurityEnvironmentIdentifier>01</iso:SecurityEnvironmentIdentifier>
			    </iso:KeyInfo>
			    <iso:SignatureGenerationInfo>MSE_RESTORE INT_AUTH</iso:SignatureGenerationInfo>
			    <iso:CertificateRef>
				<iso:DataSetName>EF.CERT_AUT</iso:DataSetName>
			    </iso:CertificateRef>
			</iso:CryptoMarker>
		    </iso:DIDMarker>
		</iso:DifferentialIdentity>
		<iso:DIDACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>CryptographicService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:CryptographicServiceAction>Sign</iso:CryptographicServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:DIDAuthentication>
				<iso:DIDName>PIN1</iso:DIDName>
				<iso:DIDState>true</iso:DIDState>
			    </iso:DIDAuthentication>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DIDACL>
	    </iso:DIDInfo>
	    <!-- signature key -->
	    <iso:DIDInfo>
		<iso:DifferentialIdentity>
		    <iso:DIDName>SK.DS</iso:DIDName>
		    <iso:DIDProtocol>urn:oid:1.3.162.15480.3.0.25</iso:DIDProtocol>
		    <iso:DIDMarker>
			<iso:CryptoMarker Protocol="urn:oid:1.3.162.15480.3.0.25">
			    <iso:AlgorithmInfo>
				<iso:Algorithm>signPKCS1_V1_5</iso:Algorithm>
				<iso:AlgorithmIdentifier>
				    <iso:Algorithm>urn:oid:1.2.840.113549.1.1</iso:Algorithm>
				</iso:AlgorithmIdentifier>
				<iso:SupportedOperations>Compute-signature Decipher Internal-authenticate</iso:SupportedOperations>
			    </iso:AlgorithmInfo>
			    <iso:KeyInfo>
				<iso:KeyRef>
				    <iso:KeyRef>01</iso:KeyRef>
				     <!--
				    Do not specify the key size to be compatible with v3.0 card and v3.4
				    (v3.0 has key size 2048 and v3.4 has key size 1024)
				    <iso:KeySize>1024</iso:KeySize>
				    -->
				</iso:KeyRef>
				<iso:SecurityEnvironmentIdentifier>01</iso:SecurityEnvironmentIdentifier>
			    </iso:KeyInfo>
			    <iso:SignatureGenerationInfo>MSE_RESTORE PSO_CDS</iso:SignatureGenerationInfo>
			    <iso:CertificateRef>
				<iso:DataSetName>EF.CERT_DS</iso:DataSetName>
			    </iso:CertificateRef>
			</iso:CryptoMarker>
		    </iso:DIDMarker>
		</iso:DifferentialIdentity>
		<iso:DIDACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>CryptographicService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:CryptographicServiceAction>Sign</iso:CryptographicServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:DIDAuthentication>
				<iso:DIDName>PIN2</iso:DIDName>
				<iso:DIDState>true</iso:DIDState>
			    </iso:DIDAuthentication>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DIDACL>
	    </iso:DIDInfo>
	    <!-- 3DesKey1, 3DesKey2 -->
	    <iso:DataSetInfo>
		<iso:DataSetName>EF.DesKeys</iso:DataSetName>
		<iso:DataSetACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DataSetSelect</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DataSetACL>
		<iso:DataSetPath>
		    <iso:efIdOrPath>0010</iso:efIdOrPath>
		</iso:DataSetPath>
	    </iso:DataSetInfo>
	    <!-- PIN Codes -->
	    <iso:DataSetInfo>
		<iso:DataSetName>EF.PINS</iso:DataSetName>
		<iso:DataSetACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DataSetSelect</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DataSetACL>
		<iso:DataSetPath>
		    <iso:efIdOrPath>0012</iso:efIdOrPath>
		</iso:DataSetPath>
	    </iso:DataSetInfo>
	    <!-- Passphrase retry counter -->
	    <iso:DataSetInfo>
		<iso:DataSetName>EF.Passphrase_Retry_Counter</iso:DataSetName>
		<iso:DataSetACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DataSetSelect</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DSIRead</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DataSetACL>
		<iso:DataSetPath>
		    <iso:efIdOrPath>0013</iso:efIdOrPath>
		</iso:DataSetPath>
	    </iso:DataSetInfo>
	    <!-- Pin retry counters -->
	    <iso:DataSetInfo>
		<iso:DataSetName>EF.PIN_Retry_Counter</iso:DataSetName>
		<iso:DataSetACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DataSetSelect</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DSIRead</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DataSetACL>
		<iso:DataSetPath>
		    <iso:efIdOrPath>0016</iso:efIdOrPath>
		</iso:DataSetPath>
	    </iso:DataSetInfo>
	    <!-- EF.ARR -->
	    <iso:DataSetInfo>
		<iso:DataSetName>EF.ARR</iso:DataSetName>
		<iso:DataSetACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DataSetSelect</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DSIRead</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DataSetACL>
		<iso:DataSetPath>
		    <iso:efIdOrPath>0030</iso:efIdOrPath>
		</iso:DataSetPath>
	    </iso:DataSetInfo>
	    <!-- Signature certificate -->
	    <iso:DataSetInfo>
		<iso:DataSetName>EF.CERT_DS</iso:DataSetName>
		<iso:DataSetACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DataSetSelect</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DSIRead</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DataSetACL>
		<iso:DataSetPath>
		    <iso:efIdOrPath>EEEEDDCE</iso:efIdOrPath>
		</iso:DataSetPath>
	    </iso:DataSetInfo>
	    <!-- Certificate for digital identication -->
	    <iso:DataSetInfo>
		<iso:DataSetName>EF.CERT_AUT</iso:DataSetName>
		<iso:DataSetACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DataSetSelect</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DSIRead</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DataSetACL>
		<iso:DataSetPath>
		    <iso:efIdOrPath>EEEEAACE</iso:efIdOrPath>
		</iso:DataSetPath>
	    </iso:DataSetInfo>
	    <!-- PD a EF with the personal data of the card holder -->
	    <iso:DataSetInfo>
		<iso:RequirementLevel>PersonalizationMandatory</iso:RequirementLevel>
		<iso:DataSetName>EF.PD</iso:DataSetName>
		<iso:DataSetACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DataSetSelect</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DSIRead</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DataSetACL>
		<iso:DataSetPath>
		    <iso:efIdOrPath>EEEE5044</iso:efIdOrPath>
		</iso:DataSetPath>
				<!--
					Contains the following information
					Surname
					First name line 1
					First name line 2
					Sex
					Nationality (3 letters)
					Birth date (dd.mm.yyyy)
					Personal identification code
					Document number
					Expiry date (dd.mm.yyyy)
					Place of birth
					Date of issuance (dd.mm.yyyy)
					Type of residence permit
					Notes*

			* variable length file
		-->
	    </iso:DataSetInfo>
	    <!-- Secret key use counter -->
	    <iso:DataSetInfo>
		<iso:DataSetName>EF.SKeyUsageCounter</iso:DataSetName>
		<iso:DataSetACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DataSetSelect</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DSIRead</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DataSetACL>
		<iso:DataSetPath>
		    <iso:efIdOrPath>EEEE0013</iso:efIdOrPath>
		</iso:DataSetPath>
	    </iso:DataSetInfo>
	    <!-- key references -->
	    <iso:DataSetInfo>
		<iso:DataSetName>EF.KeyReferences</iso:DataSetName>
		<iso:DataSetACL>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DataSetSelect</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		    <iso:AccessRule>
			<iso:CardApplicationServiceName>NamedDataService</iso:CardApplicationServiceName>
			<iso:Action>
			    <iso:NamedDataServiceAction>DSIRead</iso:NamedDataServiceAction>
			</iso:Action>
			<iso:SecurityCondition>
			    <iso:always>true</iso:always>
			</iso:SecurityCondition>
		    </iso:AccessRule>
		</iso:DataSetACL>
		<iso:DataSetPath>
		    <iso:efIdOrPath>EEEE0033</iso:efIdOrPath>
		</iso:DataSetPath>
	    </iso:DataSetInfo>
	</iso:CardApplication>
    </iso:ApplicationCapabilities>
</iso:CardInfo>
